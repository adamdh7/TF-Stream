<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TF-Stream Media Uploader & Link Generator</title>
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js';// Config - replace with your Firebase project config
const firebaseConfig = {
  apiKey: "AIzaSyDO6KqUVINsnc5tpHa9-bKbXWTqw71_GHg",
  authDomain: "tf-stream.firebaseapp.com",
  projectId: "tf-stream",
  storageBucket: "tf-stream.appspot.com",
  messagingSenderId: "112753639746",
  appId: "1:112753639746:web:b052da72f35481a8f988db",
  measurementId: "G-KXSZZ1632G"
};
const app = initializeApp(firebaseConfig);
const storage = getStorage(app);

window.addEventListener('DOMContentLoaded', () => {
  const imgForm = document.getElementById('img-form');
  const urlForm = document.getElementById('url-form');
  const output = document.getElementById('output');

  imgForm.addEventListener('submit', async e => {
    e.preventDefault();
    const file = document.getElementById('img-file').files[0];
    if (!file) return alert('Select an image');
    const storageRef = ref(storage, 'uploads/' + Date.now() + '_' + file.name);
    await uploadBytes(storageRef, file);
    const downloadUrl = await getDownloadURL(storageRef);
    const shareLink = `${location.origin}?img=${encodeURIComponent(downloadUrl)}`;
    output.innerHTML = `
      <p>üîó Shareable URL: <a href="${shareLink}" target="_blank">${shareLink}</a></p>
      <p>üñºÔ∏è Preview:</p>
      <img src="${downloadUrl}" style="max-width:100%" />
    `;
  });

  urlForm.addEventListener('submit', e => {
    e.preventDefault();
    const inputUrl = document.getElementById('external-url').value.trim();
    if (!inputUrl) return;
    let shareLink;
    // detect youtube
    const ytMatch = inputUrl.match(/(?:youtu\.be\/(?<id>[^?]+)|youtube\.com\/(?:watch\?v=|embed\/)(?<id2>[^&]+))/);
    if (ytMatch) {
      const vid = ytMatch.groups.id || ytMatch.groups.id2;
      shareLink = `${location.origin}?yt=${vid}`;
      output.innerHTML = `<p>üîó Shareable URL: <a href="${shareLink}" target="_blank">${shareLink}</a></p>
      <p>‚ñ∂Ô∏è Preview:</p>
      <iframe width="560" height="315" src="https://www.youtube.com/embed/${vid}" frameborder="0" allowfullscreen></iframe>
      <p>‚¨áÔ∏è External Download: <a href="${inputUrl}" target="_blank">Download</a></p>
      `;
    } else {
      // image URL
      shareLink = `${location.origin}?img=${encodeURIComponent(inputUrl)}`;
      output.innerHTML = `
        <p>üîó Shareable URL: <a href="${shareLink}" target="_blank">${shareLink}</a></p>
        <p>üñºÔ∏è Preview:</p>
        <img src="${inputUrl}" style="max-width:100%" />
      `;
    }
  });

  // On load, parse query params
  const params = new URLSearchParams(location.search);
  if (params.has('img')) {
    const imgUrl = decodeURIComponent(params.get('img'));
    document.getElementById('main').style.display = 'none';
    output.innerHTML = `<img src="${imgUrl}" style="max-width:100%" />`;
  }
  if (params.has('yt')) {
    const vid = params.get('yt');
    document.getElementById('main').style.display = 'none';
    output.innerHTML = `<iframe width="560" height="315" src="https://www.youtube.com/embed/${vid}" frameborder="0" allowfullscreen></iframe>`;
  }
});

  </script>
  <style>
    body { background: #111; color: #eee; font-family: sans-serif; padding: 20px; }
    h1 { text-align: center; }
    form { background: #222; padding: 16px; border-radius: 8px; margin: 16px 0; }
    input[type="text"], input[type="file"] { width: 100%; margin: 8px 0; padding: 8px; border-radius: 4px; border: none; }
    button { padding: 10px 16px; background: #0af; color: white; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background: #08c; }
    #output { margin-top: 24px; text-align: center; }
  </style>
</head>
<body>
  <h1>TF-Stream Uploader & Link Generator</h1>
  <div id="main">
    <form id="img-form">
      <h2>Upload Image</n2>
      <input type="file" id="img-file" accept="image/*" required />
      <button type="submit">Upload & Get URL</button>
    </form>
    <form id="url-form">
      <h2>Enter External URL (YouTube/Image)</h2>
      <input type="text" id="external-url" placeholder="Paste YouTube or Image URL" required />
      <button type="submit">Generate Link & Preview</button>
    </form>
  </div>
  <div id="output"></div>
</body>
</html>
